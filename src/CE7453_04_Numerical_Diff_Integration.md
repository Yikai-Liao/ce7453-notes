# CE7453 Numerical Algorithms 期末高分超详细攻略（第四章：Numerical Differentiation & Integration）

> **本章内容**：数值微分、数值积分  
> **适用对象**：零基础/考前冲刺/快速查漏补缺  
> **内容特色**：详细原理、公式推导、算法流程、例题全解、英文关键词

---

## 1. 基本概念与背景

- **数值微分（Numerical Differentiation）**：用离散点近似计算函数的导数，适用于函数表达式复杂或仅有数据点的情况。
- **数值积分（Numerical Integration）**：用有限和近似计算定积分，适用于无法解析积分或仅有数据点的情况。
- **实际应用**：工程仿真、信号处理、物理建模、数据分析等。

---

## 2. 数值微分（Numerical Differentiation）

### 2.1 差分公式（Finite Difference Formulas）

#### 2.1.1 2点前向差分（2-point forward difference）

- **公式**：  
  $$
  f'(x) \approx \frac{f(x+h) - f(x)}{h}
  $$
- **误差**：$O(h)$，截断误差较大

#### 2.1.2 3点中心差分（3-point centered difference）

- **公式**：  
  $$
  f'(x) \approx \frac{f(x+h) - f(x-h)}{2h}
  $$
- **误差**：$O(h^2)$，更精确

#### 2.1.3 5点中心差分（5-point centered difference）

- **公式**：  
  $$
  f'(x) \approx \frac{f(x-2h) - 8f(x-h) + 8f(x+h) - f(x+2h)}{12h}
  $$
- **误差**：$O(h^4)$，高精度

#### 2.1.4 Richardson 外推（Richardson Extrapolation）

- **思想**：用不同步长的近似结果组合，消除主误差项，提高精度。

### 2.2 算法流程（以3点中心差分为例）

1. 选定步长 $h$（过大误差大，过小舍入误差大）
2. 计算 $f(x+h)$ 和 $f(x-h)$
3. 按公式求导数近似值
4. 可用不同 $h$ 验证结果稳定性

### 2.3 典型例题

**例题1**：已知 $f(x)=\sin(x)$，用 $h=0.1$，求 $x=1$ 处的导数近似值（用3点中心差分）

**解答**：
- $f(1+0.1)=\sin(1.1)\approx 0.8912$
- $f(1-0.1)=\sin(0.9)\approx 0.7833$
- $f'(1)\approx \frac{0.8912-0.7833}{0.2}=0.5395$
- 精确值 $f'(1)=\cos(1)\approx 0.5403$，误差很小

**例题2**：已知 $f(x)=x^3+2x^2+1$，在 $x=2$ 处用 $h=0.2$，分别用2点前向差分、3点中心差分和5点中心差分计算导数近似值，并与精确值比较。

**解答**：
- 精确导数：$f'(x)=3x^2+4x$，在 $x=2$ 处，$f'(2)=3*(2)^2+4*2=12+8=20$
- **2点前向差分**：
  - $f(2)=2^3+2*2^2+1=8+8+1=17$
  - $f(2+0.2)=f(2.2)=(2.2)^3+2*(2.2)^2+1=10.648+9.68+1=21.328$
  - $f'(2)\approx \frac{21.328-17}{0.2}=\frac{4.328}{0.2}=21.64$
  - 误差：$|21.64-20|=1.64$
- **3点中心差分**：
  - $f(2-0.2)=f(1.8)=(1.8)^3+2*(1.8)^2+1=5.832+6.48+1=13.312$
  - $f(2+0.2)=21.328$ （如上）
  - $f'(2)\approx \frac{21.328-13.312}{2*0.2}=\frac{8.016}{0.4}=20.04$
  - 误差：$|20.04-20|=0.04$
- **5点中心差分**：
  - $f(2-0.4)=f(1.6)=(1.6)^3+2*(1.6)^2+1=4.096+5.12+1=10.216$
  - $f(2-0.2)=13.312$ （如上）
  - $f(2+0.2)=21.328$ （如上）
  - $f(2+0.4)=f(2.4)=(2.4)^3+2*(2.4)^2+1=13.824+11.52+1=26.344$
  - $f'(2)\approx \frac{10.216 - 8*13.312 + 8*21.328 - 26.344}{12*0.2}$
  - $=\frac{10.216 - 106.496 + 170.624 - 26.344}{2.4}=\frac{47.996}{2.4}=19.9983$
  - 误差：$|19.9983-20|=0.0017$
- **比较**：5点中心差分精度最高，误差最小；2点前向差分误差最大。

### 2.4 实际应用与注意事项

- **应用场景**：数值微分常用于速度、加速度计算（如运动学分析），以及优化算法中的梯度计算。
- **注意事项**：
  - 步长 $h$ 选择需平衡截断误差和舍入误差，建议多次尝试不同 $h$ 值。
  - 对于噪声数据，数值微分会放大噪声，需先平滑处理数据。

---

## 3. 数值积分（Numerical Integration）

### 3.1 Newton-Cotes 公式

#### 3.1.1 梯形法（Trapezoidal Rule）

- **公式**：  
  $$
  \int_a^b f(x)dx \approx \frac{h}{2}[f(a) + f(b)]
  $$
  其中 $h=b-a$

- **复合梯形法**：将区间分为 $n$ 段，累加每段梯形面积
  $$
  \int_a^b f(x)dx \approx \frac{h}{2}[f(a) + 2\sum_{k=1}^{n-1}f(a+kh) + f(b)]
  $$

#### 3.1.2 Simpson 法（Simpson's Rule）

- **公式**：  
  $$
  \int_a^b f(x)dx \approx \frac{h}{3}[f(a) + 4f((a+b)/2) + f(b)]
  $$
  $h=(b-a)/2$

- **复合Simpson法**：区间分偶数段，累加每段Simpson近似
  $$
  \int_a^b f(x)dx \approx \frac{h}{3}[f(a) + 4\sum_{k=1,3,...}^{n-1}f(a+kh) + 2\sum_{k=2,4,...}^{n-2}f(a+kh) + f(b)]
  $$

#### 3.1.3 Romberg 积分（Romberg Integration）

- **思想**：用梯形法结果递推外推，提高精度。基于 Richardson 外推，通过多次梯形法计算，逐步消除误差项。

#### 3.1.4 高斯求积（Gaussian Quadrature）

- **思想**：选取最优节点和权重，使多项式积分精度最高。对于 $n$ 点高斯求积，对最高 $2n-1$ 次多项式精确。

### 3.2 算法流程（以复合梯形法为例）

1. 将 $[a,b]$ 分为 $n$ 段，步长 $h=(b-a)/n$
2. 计算端点 $f(a), f(b)$
3. 计算中间点 $f(a+kh)$，$k=1,2,...,n-1$
4. 按公式累加求和

### 3.3 典型例题

**例题1**：用复合梯形法计算 $\int_0^1 e^x dx$，分4段

**解答**：
- $h=0.25$
- $x_0=0, x_1=0.25, x_2=0.5, x_3=0.75, x_4=1$
- $f(x_0)=1, f(x_1)=1.2840, f(x_2)=1.6487, f(x_3)=2.1170, f(x_4)=2.7183$
- $I\approx \frac{0.25}{2}[1+2(1.2840+1.6487+2.1170)+2.7183]=1.7183$
- 精确值 $e-1\approx 1.7183$，误差很小

**例题2**：用Simpson法计算积分 $\int_0^1 x^2 dx$，分2段

**解答步骤**：
1. $h=0.5$，点：$x_0=0, x_1=0.5, x_2=1$
2. $f(x_0)=0, f(x_1)=0.25, f(x_2)=1$
3. $I \approx \frac{0.5}{3} [0 + 4*0.25 + 1] = \frac{0.5}{3} [0 + 1 + 1] = \frac{0.5}{3} * 2 = \frac{1}{3}$
4. 精确值 $\frac{1}{3}$，误差为0。

**例题3**：用Romberg积分计算 $\int_0^1 \frac{4}{1+x^2} dx$，取初始 $n=1$，进行两次外推。

**解答步骤**：
- 该积分精确值为 $\pi \approx 3.1415926535$，用于验证误差。
- **第一步：梯形法，不同分割**：
  - $n=1$，$h=1$，$T_1(1)=\frac{1}{2}[f(0)+f(1)]=\frac{1}{2}[4+2]=3$
  - $n=2$，$h=0.5$，$T_1(2)=\frac{0.5}{2}[f(0)+2f(0.5)+f(1)]=\frac{0.5}{2}[4+2*3.2+2]=3.2$
  - $n=4$，$h=0.25$，$T_1(4)=\frac{0.25}{2}[f(0)+2(f(0.25)+f(0.5)+f(0.75))+f(1)]$
    - $f(0.25)=\frac{4}{1+0.0625}=3.7647$, $f(0.5)=3.2$, $f(0.75)=\frac{4}{1+0.5625}=2.56$
    - $T_1(4)=\frac{0.25}{2}[4+2*(3.7647+3.2+2.56)+2]=3.1466$
- **第二步：Romberg外推**：
  - 第一次外推：$T_2(2)=\frac{4*T_1(2)-T_1(1)}{4-1}=\frac{4*3.2-3}{3}=3.2667$
  - 第二次外推：$T_2(4)=\frac{4*T_1(4)-T_1(2)}{4-1}=\frac{4*3.1466-3.2}{3}=3.1287$
  - 继续外推：$T_3(4)=\frac{4*T_2(4)-T_2(2)}{4-1}=\frac{4*3.1287-3.2667}{3}=3.1493$
- **结果**：$T_3(4)=3.1493$，与 $\pi$ 较接近，误差约为 $0.0077$。

### 3.4 实际应用与注意事项

- **应用场景**：数值积分用于计算面积、体积、概率密度积分、物理量累积（如功、能量）。
- **注意事项**：
  - 增加分割数 $n$ 可提高精度，但计算量增加。
  - 对于周期性函数或振荡函数，高斯求积可能更有效。
  - Romberg 积分适合快速收敛，但对函数平滑性要求较高。

---

## 4. 常见考点与易错点

- 步长 $h$ 选取不当导致误差大
- 舍入误差与截断误差权衡
- 复合公式累加时端点权重
- 高斯求积节点和权重记忆
- 英文术语拼写与公式记忆

---

## 5. 英文关键词与表达

- numerical differentiation, finite difference, truncation error, round-off error, Richardson extrapolation, step size
- numerical integration, Newton-Cotes, trapezoidal rule, Simpson's rule, Romberg integration, Gaussian quadrature, composite rule, node, weight

---

如需更详细例题推导或某一算法的代码实现，可随时补充！